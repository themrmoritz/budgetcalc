<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boost Strategic Campaign Builder</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Compact Scaling for 1366x768 optimization */
        .app-container {
            transform: scale(0.95); 
            transform-origin: top center;
        }
        
        /* Custom Range Slider Styling */
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #0f172a;
            cursor: pointer;
            border-radius: 50%;
            transition: transform 0.1s;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider-thumb::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        /* Animations */
        .slide-in { animation: slideIn 0.3s ease-out forwards; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Step Visibility */
        .step-hidden { display: none; }
        .step-active { display: block; }

        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Sticky Sidebar Utilities */
        .sticky-sidebar {
            position: sticky;
            top: 0.5rem;
            max-height: calc(100vh - 1rem);
            overflow-y: auto;
        }

        /* Card Selection Styles */
        .card-selected {
            border-color: #0f172a; 
            background-color: #f8fafc;
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.1);
        }
        .card-unselected {
            border-color: #e2e8f0;
            background-color: #ffffff;
            opacity: 0.8;
        }
        .card-unselected:hover {
            opacity: 1;
            border-color: #94a3b8;
        }
        
        .card-permanent {
            border-color: #0f172a;
            background-color: #f8fafc;
            opacity: 1;
        }
    </style>
</head>
<body class="bg-white min-h-screen text-slate-800 flex justify-center items-start overflow-x-hidden text-sm">

    <!-- Scaled Wrapper -->
    <div class="app-container w-full max-w-[1280px] p-2">
        
        <!-- Main Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-4 relative">
            
            <!-- LEFT COLUMN: MAIN CONTENT -->
            <div id="layout-main" class="col-span-1 lg:col-span-8 bg-white rounded-[1.5rem] shadow-xl border border-slate-200 min-h-[500px] flex flex-col relative overflow-hidden transition-all duration-300">
                
                <!-- Progress Indicator -->
                <div class="px-6 py-4 border-b border-slate-100">
                    <div class="flex justify-between text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2" id="progress-labels">
                        <span>ROI</span>
                        <span>Blueprint</span>
                        <span>Creative</span>
                        <span>Prod</span>
                        <span>Follow Up</span>
                        <span>Summary</span>
                        <span>Scale</span>
                    </div>
                    <div class="h-1 bg-slate-100 rounded-full overflow-hidden">
                        <div id="progress-fill" class="h-full bg-slate-900 transition-all duration-500 ease-out" style="width: 14%"></div>
                    </div>
                </div>

                <!-- CONTENT AREA -->
                <div class="flex-1 p-6 md:p-8 overflow-y-auto custom-scroll relative">

                    <!-- STEP 1: ROI PILOT BUDGET -->
                    <div id="step-1" class="step-active slide-in">
                        <h2 class="text-2xl font-black text-slate-900 uppercase mb-1">ROI Pilot Budget</h2>
                        <p class="text-slate-500 font-medium mb-6 text-xs">Let's set some targets to calculate your break-even budget ceiling.</p>

                        <div class="space-y-5 max-w-3xl">
                            <!-- Row 1: Targets & Conv -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-slate-50 p-4 rounded-xl border border-slate-200">
                                <div>
                                    <label class="text-[10px] font-bold text-slate-500 uppercase tracking-wide mb-1 block">Target Prospects</label>
                                    <input type="number" id="input-targets" value="50" class="w-full p-2 border border-slate-200 rounded-lg focus:border-slate-900 focus:outline-none font-bold text-slate-900 text-lg bg-white">
                                </div>
                                <div>
                                    <div class="flex justify-between mb-1">
                                        <label class="text-[10px] font-bold text-slate-500 uppercase tracking-wide">Target Conv. Rate</label>
                                        <span id="display-conv" class="text-lg font-black text-slate-900">2.0%</span>
                                    </div>
                                    <input type="range" id="input-conv" min="0.1" max="10" step="0.1" value="2.0" class="w-full h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer slider-thumb">
                                </div>
                            </div>

                            <!-- Row 2: Customer Value -->
                            <div>
                                <h3 class="text-xs font-bold text-slate-900 uppercase mb-3 flex items-center gap-2">
                                    <i data-lucide="calculator" class="w-3 h-3"></i>
                                    Customer Value
                                </h3>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                    <!-- Spend -->
                                    <div>
                                        <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-wide mb-1">Annual Client Spend</label>
                                        <div class="relative w-full">
                                            <span class="absolute left-3 top-2.5 text-slate-400 font-bold text-xs">$</span>
                                            <input type="number" id="input-spend" value="75000" class="w-full p-2 pl-6 border border-slate-200 rounded-lg focus:border-slate-900 focus:outline-none font-bold text-slate-900 text-sm">
                                        </div>
                                    </div>
                                    
                                    <!-- Tenure -->
                                    <div>
                                        <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-wide mb-1">Client Tenure (Years)</label>
                                        <div class="flex items-center gap-2">
                                            <div class="flex-grow">
                                                <input type="range" id="input-tenure" min="1" max="10" step="1" value="1" class="w-full h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer slider-thumb">
                                                <div class="flex justify-between text-[9px] font-bold text-slate-400 mt-1 uppercase">
                                                    <span>1yr</span>
                                                    <span>10yr</span>
                                                </div>
                                            </div>
                                            <div class="w-10 h-8 bg-white border border-slate-200 rounded flex items-center justify-center font-black text-slate-900 shadow-sm text-sm">
                                                <span id="display-tenure">1</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Break Even Calculation Row -->
                                <div class="p-3 bg-slate-100 rounded-xl border border-slate-200 flex flex-col md:flex-row justify-between items-center gap-3">
                                    <div class="flex flex-col">
                                        <span class="text-[9px] font-bold text-slate-500 uppercase mb-0.5">New Client LTV</span>
                                        <span id="display-ltv" class="text-lg font-black text-slate-900">$75,000</span>
                                    </div>
                                    
                                    <div class="text-slate-400 font-bold text-lg">Ã—</div>
                                    
                                    <div class="flex flex-col">
                                        <label class="text-[9px] font-bold text-slate-500 uppercase mb-0.5">Profit Margin</label>
                                        <div class="flex items-center gap-1 bg-white px-2 py-0.5 rounded border border-slate-300">
                                            <input type="number" id="input-margin" value="37" class="bg-transparent font-bold text-slate-900 text-sm w-10 focus:outline-none text-center">
                                            <span class="text-slate-400 font-bold text-xs">%</span>
                                        </div>
                                    </div>

                                    <div class="text-slate-400 font-bold text-lg">=</div>

                                    <div class="flex flex-col items-end">
                                        <span class="text-[9px] font-bold text-slate-500 uppercase mb-0.5">Break Even Ceiling</span>
                                        <span id="display-breakeven-row" class="text-xl font-black text-emerald-600">$27,750</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 2: BLUEPRINT -->
                    <div id="step-2" class="step-hidden slide-in">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-full">
                            <!-- Content -->
                            <div>
                                <h2 class="text-2xl font-black text-slate-900 mb-1">Phase 1: The Blueprint</h2>
                                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Strategy & Narrative</h3>
                                <p class="text-slate-400 text-[10px] font-medium mb-4">One-time investment. Foundation for all future marketing.</p>
                                
                                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                                    <h4 class="font-bold text-slate-900 mb-3 flex items-center gap-2 text-xs">
                                        <i data-lucide="check-circle-2" class="w-3 h-3 text-slate-900"></i>
                                        Deliverables
                                    </h4>
                                    <ul class="space-y-3 text-xs text-slate-600">
                                        <li class="flex gap-2">
                                            <div class="w-1 h-1 rounded-full bg-slate-400 mt-1.5 flex-shrink-0"></div>
                                            <span><strong>Strategy Workshop:</strong> One half-day session to extract wholesale story & tech assets.</span>
                                        </li>
                                        <li class="flex gap-2">
                                            <div class="w-1 h-1 rounded-full bg-slate-400 mt-1.5 flex-shrink-0"></div>
                                            <span><strong>Strategic Narrative Doc:</strong> The core messaging bible for differentiation.</span>
                                        </li>
                                        <li class="flex gap-2">
                                            <div class="w-1 h-1 rounded-full bg-slate-400 mt-1.5 flex-shrink-0"></div>
                                            <span><strong>Campaign Attack Plan:</strong> Timeline and list scrubbing for top 200 prospects.</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- Price Card -->
                            <div class="flex items-center justify-center">
                                <div class="w-full bg-slate-50 text-slate-900 p-6 rounded-2xl text-center shadow-md border border-slate-100 relative overflow-hidden">
                                    <span class="block text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1">Phase 1 Investment</span>
                                    <div class="text-4xl font-bold tracking-tight mb-2">$5,000</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 3: CREATIVE -->
                    <div id="step-3" class="step-hidden slide-in">
                        <div class="mb-4">
                            <h2 class="text-2xl font-black text-slate-900 mb-1">Phase 2: Package Design</h2>
                            <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider">DM Creative Development</h3>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-full">
                            <div>
                                <p class="text-slate-600 mb-4 leading-relaxed text-xs">
                                    Ideation and development of the physical gift and unboxing experience.
                                </p>

                                <ul class="space-y-2 mb-4">
                                    <li class="flex items-center gap-3 p-2 bg-white border border-slate-100 rounded-lg shadow-sm">
                                        <i data-lucide="check" class="w-4 h-4 text-slate-900"></i>
                                        <span class="font-bold text-slate-700 text-xs">Creative Strategy & Ideation</span>
                                    </li>
                                    <li class="flex items-center gap-3 p-2 bg-white border border-slate-100 rounded-lg shadow-sm">
                                        <i data-lucide="check" class="w-4 h-4 text-slate-900"></i>
                                        <span class="font-bold text-slate-700 text-xs">Copywriting & Design</span>
                                    </li>
                                    <li class="flex items-center gap-3 p-2 bg-white border border-slate-100 rounded-lg shadow-sm">
                                        <i data-lucide="check" class="w-4 h-4 text-slate-900"></i>
                                        <span class="font-bold text-slate-700 text-xs">Digital File Prep</span>
                                    </li>
                                </ul>
                            </div>
                            
                            <!-- Price Card -->
                            <div class="flex items-center justify-center">
                                <div class="w-full bg-slate-50 text-slate-900 p-6 rounded-2xl text-center shadow-md border border-slate-100 relative overflow-hidden">
                                    <span class="block text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1">Phase 2 Investment</span>
                                    <div class="text-3xl font-bold tracking-tight mb-2">$5k - $7.5k</div>
                                    <p class="text-slate-400 text-[10px] font-medium max-w-[240px] mx-auto mt-2">Range depends on concept intricacy. Includes content & packaging design.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 4: PRODUCTION (Cards) -->
                    <div id="step-4" class="step-hidden slide-in">
                        <div class="mb-4">
                            <h2 class="text-2xl font-black text-slate-900 mb-1">Phase 2b: DM Production</h2>
                            <p class="text-slate-500 text-xs">Select who will handle the execution.</p>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Left Column: Inputs -->
                            <div class="space-y-4">
                                <!-- Manufacturing -->
                                <div>
                                    <h3 class="font-bold text-slate-900 text-xs mb-2 flex items-center gap-2">
                                        <i data-lucide="package" class="w-4 h-4 text-slate-500"></i>
                                        Manufacturing
                                    </h3>
                                    <div class="grid grid-cols-2 gap-3">
                                        <!-- Option 1: Mr Moritz -->
                                        <div id="card-man-mr" class="border rounded-lg p-3 cursor-pointer transition-all card-selected relative" onclick="toggleProd('man', 'mr')">
                                            <div class="flex justify-between items-start mb-2">
                                                <span class="font-bold text-slate-900 text-xs">Mr. Moritz +Team</span>
                                                <div id="check-man-mr" class="w-4 h-4 rounded-full bg-slate-900 text-white flex items-center justify-center">
                                                    <i data-lucide="check" class="w-2 h-2"></i>
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-1 mb-1">
                                                <label class="text-[10px] font-bold text-slate-600">Cost:</label>
                                                <div class="relative w-16">
                                                    <span class="absolute left-1.5 top-1 text-slate-400 font-bold text-[9px]">$</span>
                                                    <input type="number" id="input-man-cost" value="100" class="w-full p-0.5 pl-3 rounded border border-slate-300 font-bold text-slate-900 text-xs" onclick="event.stopPropagation()">
                                                </div>
                                                <span class="text-[9px] text-slate-400">/ pack</span>
                                            </div>
                                        </div>

                                        <!-- Option 2: Boost -->
                                        <div id="card-man-boost" class="border rounded-lg p-3 cursor-pointer transition-all card-unselected relative" onclick="toggleProd('man', 'boost')">
                                            <div class="flex justify-between items-start mb-2">
                                                <span class="font-bold text-slate-900 text-xs">Boost / Client</span>
                                                <div id="check-man-boost" class="w-4 h-4 rounded-full bg-slate-200 text-slate-400 flex items-center justify-center hidden">
                                                    <i data-lucide="check" class="w-2 h-2"></i>
                                                </div>
                                            </div>
                                            <p class="font-bold text-xs">$0 (Internal)</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Distribution -->
                                <div>
                                    <h3 class="font-bold text-slate-900 text-xs mb-2 flex items-center gap-2">
                                        <i data-lucide="truck" class="w-4 h-4 text-slate-500"></i>
                                        Distribution
                                    </h3>
                                    <div class="grid grid-cols-2 gap-3">
                                        <!-- Option 1: Mr Moritz -->
                                        <div id="card-dist-mr" class="border rounded-lg p-3 cursor-pointer transition-all card-selected relative" onclick="toggleProd('dist', 'mr')">
                                            <div class="flex justify-between items-start mb-2">
                                                <span class="font-bold text-slate-900 text-xs">Mr. Moritz +Team</span>
                                                <div id="check-dist-mr" class="w-4 h-4 rounded-full bg-slate-900 text-white flex items-center justify-center">
                                                    <i data-lucide="check" class="w-2 h-2"></i>
                                                </div>
                                            </div>
                                            <p class="font-bold text-xs">$1,500</p>
                                            <p class="text-[9px] text-slate-500">+ Shipping ($1-2k)</p>
                                        </div>

                                        <!-- Option 2: Boost -->
                                        <div id="card-dist-boost" class="border rounded-lg p-3 cursor-pointer transition-all card-unselected relative" onclick="toggleProd('dist', 'boost')">
                                            <div class="flex justify-between items-start mb-2">
                                                <span class="font-bold text-slate-900 text-xs">Boost / Client</span>
                                                <div id="check-dist-boost" class="w-4 h-4 rounded-full bg-slate-200 text-slate-400 flex items-center justify-center hidden">
                                                    <i data-lucide="check" class="w-2 h-2"></i>
                                                </div>
                                            </div>
                                            <p class="font-bold text-xs">$0 (Internal)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column: Price Card (New for this layout) -->
                            <div class="flex items-center justify-center">
                                <div class="w-full bg-slate-50 text-slate-900 p-6 rounded-2xl text-center shadow-md border border-slate-100 relative overflow-hidden">
                                    <span class="block text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1">Phase 2b Investment</span>
                                    <div class="text-4xl font-bold tracking-tight mb-2" id="display-phase2b-total">$0</div>
                                    <p class="text-slate-400 text-[10px] font-medium max-w-[200px] mx-auto mt-2">Includes Manufacturing & Distribution based on selection.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 5: FOLLOW UP (ADD ONS) -->
                    <div id="step-5" class="step-hidden slide-in">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-full">
                            <div>
                                <h2 class="text-2xl font-black text-slate-900 mb-1">Phase 3: The Follow-Up</h2>
                                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-4">Sales Enablement</h3>
                                
                                <div class="space-y-3">
                                    <!-- Required Item (Styling Updated) -->
                                    <div class="flex items-start gap-3 p-3 rounded-xl border-2 card-permanent">
                                        <div class="flex-1">
                                            <div class="flex justify-between w-full">
                                                <span class="font-bold text-slate-900 text-xs">Project + Creative Support</span>
                                                <span class="font-bold text-slate-600 text-xs">$1,500/mo</span>
                                            </div>
                                            <p class="text-[10px] text-slate-500 mt-0.5">Ongoing campaign management (90 Days).</p>
                                        </div>
                                    </div>

                                    <!-- Option 1 -->
                                    <label class="flex items-start gap-3 p-3 rounded-xl border border-slate-300 bg-slate-50 cursor-pointer transition-all relative group">
                                        <input type="checkbox" id="check-nurture" class="mt-0.5 w-4 h-4 accent-slate-900" checked onchange="calculateTotal()">
                                        <div>
                                            <div class="flex justify-between w-full">
                                                <span class="font-bold text-slate-900 text-xs">Follow-Up Nurture Comms</span>
                                                <span class="font-bold text-slate-600 text-xs">+$750</span>
                                            </div>
                                            <p class="text-[10px] text-slate-500 mt-0.5">Messaging journey & copy for sales team.</p>
                                        </div>
                                    </label>

                                    <!-- Option 2 -->
                                    <label class="flex items-start gap-3 p-3 rounded-xl border border-slate-300 bg-slate-50 cursor-pointer transition-all relative group" id="card-deck">
                                        <input type="checkbox" id="check-deck" class="mt-0.5 w-4 h-4 accent-slate-900" checked onchange="toggleCardStyle('deck')">
                                        <div>
                                            <div class="flex justify-between w-full">
                                                <span class="font-bold text-slate-900 text-xs">"Closer" Sales Deck</span>
                                                <span class="font-bold text-slate-600 text-xs">+$2,000</span>
                                            </div>
                                            <p class="text-[10px] text-slate-500 mt-0.5">Scripting & design for leave-behind deck.</p>
                                        </div>
                                    </label>

                                    <!-- Option 3 -->
                                    <label class="flex items-start gap-3 p-3 rounded-xl border border-slate-300 bg-slate-50 cursor-pointer transition-all relative group" id="card-lp">
                                        <input type="checkbox" id="check-lp" class="mt-0.5 w-4 h-4 accent-slate-900" checked onchange="toggleCardStyle('lp')">
                                        <div>
                                            <div class="flex justify-between w-full">
                                                <span class="font-bold text-slate-900 text-xs">Campaign Landing Page</span>
                                                <span class="font-bold text-slate-600 text-xs">+$2,000</span>
                                            </div>
                                            <p class="text-[10px] text-slate-500 mt-0.5">Copy & design optimised for conversion.</p>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Dynamic Price Card -->
                            <div class="flex items-center justify-center">
                                <div class="w-full bg-slate-50 text-slate-900 p-6 rounded-2xl text-center shadow-md border border-slate-100 relative overflow-hidden">
                                    <span class="block text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1">Phase 3 Investment</span>
                                    <div class="text-4xl font-bold tracking-tight mb-2" id="display-phase3-total">$9,250</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 6: SUMMARY PAGE -->
                    <div id="step-6" class="step-hidden slide-in">
                        <div class="text-center mb-6">
                            <h2 class="text-3xl font-black text-slate-900 mb-1">Campaign Ready</h2>
                            <p class="text-slate-500 text-xs">Review your configured B2B Pain Relief campaign.</p>
                        </div>

                        <div class="bg-slate-200 border border-slate-300 rounded-lg overflow-hidden max-w-xl mx-auto shadow-md">
                            <!-- Header -->
                            <div class="p-4 flex justify-between items-center border-b border-slate-300">
                                <h3 class="font-black text-slate-900 uppercase text-sm tracking-tight">LINE ITEM BREAKDOWN</h3>
                                <span class="bg-slate-900 text-white text-[10px] font-bold px-2 py-0.5 rounded-full uppercase">90 Day Pilot</span>
                            </div>
                            
                            <!-- List Items -->
                            <div class="divide-y divide-slate-300">
                                <div class="p-4 flex justify-between items-center bg-white/50 text-xs">
                                    <span class="font-medium text-slate-700">1. Blueprint</span>
                                    <span class="font-bold text-slate-900">$5,000</span>
                                </div>
                                <div class="p-4 flex justify-between items-center bg-white/50 text-xs">
                                    <span class="font-medium text-slate-700">2. Creative</span>
                                    <span class="font-bold text-slate-900">$5,000 - $7,500</span>
                                </div>
                                <div class="p-4 flex justify-between items-center bg-white/50 text-xs">
                                    <span class="font-medium text-slate-700">2B. Production</span>
                                    <span class="font-bold text-slate-900" id="summary-row-prod">$0</span>
                                </div>
                                <div class="p-4 flex justify-between items-center bg-white/50 text-xs">
                                    <span class="font-medium text-slate-700">3. Follow-Up</span>
                                    <span class="font-bold text-slate-900" id="summary-row-follow">$0</span>
                                </div>
                            </div>

                            <!-- Footer Total -->
                            <div class="p-4 bg-slate-900 text-white flex justify-between items-center">
                                <span class="font-medium text-slate-400 text-xs">Total Investment Range</span>
                                <span class="text-xl font-bold" id="final-summary-total">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 7: SCALE COMPARISON -->
                    <div id="step-7" class="step-hidden slide-in">
                        <div class="text-center mb-6">
                            <h2 class="text-2xl font-black text-slate-900 mb-1">Campaign Scale Projection</h2>
                            <p class="text-slate-500 text-xs">Compare your pilot investment with the 12-month rollout.</p>
                        </div>

                        <div class="bg-white border-2 border-slate-100 rounded-2xl overflow-hidden max-w-4xl mx-auto shadow-lg text-xs">
                            <table class="w-full">
                                <thead class="bg-slate-50 border-b border-slate-200">
                                    <tr>
                                        <th class="p-4 text-left font-black text-slate-900 uppercase w-1/3">Line Item</th>
                                        <th class="p-4 text-right font-black text-slate-900 uppercase w-1/3">
                                            90 Day Pilot
                                            <span class="block text-[10px] text-slate-500 font-medium normal-case mt-0.5" id="scale-qty-90">50 Packages</span>
                                            <span class="block text-[9px] text-emerald-600 font-bold normal-case mt-0.5" id="scale-clients-90">1 New Client</span>
                                        </th>
                                        <th class="p-4 text-right font-black text-slate-900 uppercase bg-slate-100 w-1/3">
                                            12 Month Campaign
                                            <span class="block text-[10px] text-slate-500 font-medium normal-case mt-0.5" id="scale-qty-12m">200 Packages</span>
                                            <span class="block text-[9px] text-emerald-600 font-bold normal-case mt-0.5" id="scale-clients-12m">4 New Clients</span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-100">
                                    <tr>
                                        <td class="p-4 font-bold text-slate-700">Blueprint</td>
                                        <td class="p-4 text-right font-medium text-slate-900">$5,000</td>
                                        <td class="p-4 text-right font-medium text-slate-500 bg-slate-50">$0</td>
                                    </tr>
                                    <tr>
                                        <td class="p-4 font-bold text-slate-700">Creative</td>
                                        <td class="p-4 text-right font-medium text-slate-900">$5,000 - $7,500</td>
                                        <td class="p-4 text-right font-medium text-slate-500 bg-slate-50">$0</td>
                                    </tr>
                                    <tr>
                                        <td class="p-4 font-bold text-slate-700">Production</td>
                                        <td class="p-4 text-right font-medium text-slate-900" id="scale-row-prod-90">$0</td>
                                        <td class="p-4 text-right font-medium text-slate-900 bg-slate-50" id="scale-row-prod-12m">$0</td>
                                    </tr>
                                    <tr>
                                        <td class="p-4 font-bold text-slate-700">Follow-Up</td>
                                        <td class="p-4 text-right font-medium text-slate-900" id="scale-row-follow-90">$0</td>
                                        <td class="p-4 text-right font-medium text-slate-900 bg-slate-50">$6,000</td>
                                    </tr>
                                </tbody>
                                <tfoot class="bg-slate-900 text-white border-t-4 border-white">
                                    <tr>
                                        <td class="p-4 font-medium text-slate-400">Total Investment</td>
                                        <td class="p-4 text-right text-lg font-bold" id="scale-total-90">$0</td>
                                        <td class="p-4 text-right text-lg font-bold bg-slate-800" id="scale-total-12m">$0</td>
                                    </tr>
                                    <tr class="bg-slate-950 text-slate-400 border-t border-slate-800">
                                        <td class="p-3 font-bold uppercase text-[10px]">Break Even Budget</td>
                                        <td class="p-3 text-right font-mono text-emerald-400 font-bold" id="scale-breakeven-90">$0</td>
                                        <td class="p-3 text-right font-mono text-emerald-400 font-bold bg-slate-900" id="scale-breakeven-12m">$0</td>
                                    </tr>
                                    <!-- ROI Row -->
                                    <tr class="bg-slate-950 text-slate-400 border-t border-slate-800">
                                        <td class="p-3 font-bold uppercase text-[10px]">ROI % (Budget/Investment)</td>
                                        <td class="p-3 text-right font-mono text-emerald-400 font-bold" id="scale-roi-90">0%</td>
                                        <td class="p-3 text-right font-mono text-emerald-400 font-bold bg-slate-900" id="scale-roi-12m">0%</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                </div>

                <!-- FOOTER NAV -->
                <div class="px-6 py-4 border-t border-slate-200 bg-slate-50 flex justify-between items-center z-10">
                    <button id="btn-back" class="flex items-center gap-2 px-4 py-2 rounded-lg text-slate-500 font-bold hover:bg-slate-200 transition-colors disabled:opacity-30 disabled:cursor-not-allowed text-xs" disabled>
                        <i data-lucide="arrow-left" class="w-3 h-3"></i>
                        Back
                    </button>
                    <button id="btn-next" class="flex items-center gap-2 px-6 py-2 rounded-lg bg-slate-900 text-white font-bold hover:bg-slate-800 transition-transform active:scale-95 shadow-lg shadow-slate-900/20 text-xs">
                        Next Step
                        <i data-lucide="arrow-right" class="w-3 h-3"></i>
                    </button>
                </div>
            </div>

            <!-- RIGHT COLUMN: SIDEBAR (Reverted Design) -->
            <div id="layout-sidebar" class="col-span-1 lg:col-span-4 pl-0 lg:pl-4 transition-all duration-300">
                <div class="sticky-sidebar">
                    <div class="bg-white border-2 border-slate-200 rounded-2xl p-5 shadow-sm">
                        
                        <!-- Reverted Header (Plain Active Ingredients) -->
                        <div class="text-center pb-3 mb-3 border-b border-slate-100">
                            <h3 class="font-black text-slate-900 uppercase text-base tracking-tight mb-1">B2B MARKETING PAIN RELIEF</h3>
                            <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest block">ACTIVE INGREDIENTS</span>
                            <!-- Dynamic Centered Context -->
                            <div id="sidebar-context" class="text-[9px] text-slate-500 font-medium mt-2 leading-tight">
                                ...
                            </div>
                        </div>

                        <!-- Ingredients List -->
                        <div class="space-y-2 text-xs mb-4 max-h-[350px] overflow-y-auto pr-2 custom-scroll" id="summary-list">
                            <div class="text-center text-slate-400 italic text-[10px] py-4">Initializing...</div>
                        </div>
                        
                        <!-- Budget Progress -->
                        <div class="mb-4">
                            <div class="flex justify-between items-end mb-1">
                                <span class="text-[9px] font-bold text-slate-400 uppercase">Budget Usage</span>
                                <span id="budget-percent" class="text-[9px] font-bold text-slate-900">0%</span>
                            </div>
                            <div class="w-full bg-slate-100 rounded-full h-1.5 overflow-hidden">
                                <div id="budget-bar" class="bg-slate-900 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                            </div>
                        </div>

                        <!-- Totals Box (Side by Side) -->
                        <div class="bg-slate-50 rounded-xl p-3 border border-slate-200">
                            <div class="grid grid-cols-2 gap-2">
                                <div class="text-left">
                                    <span class="text-[9px] font-bold text-slate-400 uppercase block mb-0.5">Break-Even Budget</span>
                                    <span id="summary-budget" class="font-bold text-slate-500 text-xs leading-tight">$0</span>
                                </div>
                                <div class="text-right">
                                    <span class="text-[9px] font-bold text-slate-500 uppercase block mb-0.5">Est. Investment</span>
                                    <span id="summary-total" class="font-black text-slate-900 text-sm leading-tight">$0</span>
                                </div>
                            </div>
                            
                            <!-- Warning -->
                            <div id="budget-warning" class="hidden mt-2 text-center">
                                <div class="inline-flex items-center gap-1 text-[9px] font-bold text-red-600 bg-red-50 px-2 py-1 rounded border border-red-100 w-full justify-center">
                                    <i data-lucide="alert-triangle" class="w-3 h-3"></i>
                                    Over Budget
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <span class="text-[9px] font-bold text-slate-300 uppercase tracking-widest">Dosage: 90 Days</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- STATE & DATA ---
        const state = {
            step: 1,
            totalSteps: 7, 
            inputs: {
                targets: 50,
                conv: 2.0,
                spend: 75000,
                tenure: 1,
                margin: 37,
                manSource: 'mr', 
                manCost: 100,
                distSource: 'mr',
                distBase: 1500,
                distMat: 1500, 
                nurture: true,
                deck: true,
                lp: true
            },
            costs: {
                phase1: 5000,
                phase2Min: 5000,
                phase2Max: 7500,
                phase3: 10250, 
                prodTotal: 0
            },
            budgetLimit: 0
        };

        // --- ELEMENTS ---
        const els = {
            layoutMain: document.getElementById('layout-main'),
            layoutSidebar: document.getElementById('layout-sidebar'),
            targets: document.getElementById('input-targets'),
            conv: document.getElementById('input-conv'),
            spend: document.getElementById('input-spend'),
            tenure: document.getElementById('input-tenure'),
            margin: document.getElementById('input-margin'),
            manCost: document.getElementById('input-man-cost'),
            nurture: document.getElementById('check-nurture'),
            deck: document.getElementById('check-deck'),
            lp: document.getElementById('check-lp'),
            screens: [1,2,3,4,5,6,7].map(i => document.getElementById(`step-${i}`)),
            btnNext: document.getElementById('btn-next'),
            btnBack: document.getElementById('btn-back'),
            progressBar: document.getElementById('progress-fill'),
            progressLabels: document.getElementById('progress-labels').children,
            displayLtv: document.getElementById('display-ltv'),
            displayConv: document.getElementById('display-conv'),
            displayTenure: document.getElementById('display-tenure'),
            phase3Total: document.getElementById('display-phase3-total'),
            summaryList: document.getElementById('summary-list'),
            summaryTotal: document.getElementById('summary-total'),
            summaryBudget: document.getElementById('summary-budget'),
            displayBreakevenRow: document.getElementById('display-breakeven-row'),
            budgetWarning: document.getElementById('budget-warning'),
            budgetBar: document.getElementById('budget-bar'),
            budgetPercent: document.getElementById('budget-percent'),
            sidebarContext: document.getElementById('sidebar-context'),
            // Phase 2b Total
            displayPhase2bTotal: document.getElementById('display-phase2b-total'),
            // Step 6 (Summary)
            summaryRowProd: document.getElementById('summary-row-prod'),
            summaryRowFollow: document.getElementById('summary-row-follow'),
            finalSummaryTotal: document.getElementById('final-summary-total'),
            // Step 7 (Scale)
            scaleQty90: document.getElementById('scale-qty-90'),
            scaleClients90: document.getElementById('scale-clients-90'),
            scaleQty12m: document.getElementById('scale-qty-12m'),
            scaleClients12m: document.getElementById('scale-clients-12m'),
            scaleRowProd90: document.getElementById('scale-row-prod-90'),
            scaleRowProd12m: document.getElementById('scale-row-prod-12m'),
            scaleRowFollow90: document.getElementById('scale-row-follow-90'),
            scaleTotal90: document.getElementById('scale-total-90'),
            scaleTotal12m: document.getElementById('scale-total-12m'),
            scaleBreakeven90: document.getElementById('scale-breakeven-90'),
            scaleBreakeven12m: document.getElementById('scale-breakeven-12m'),
            scaleRoi90: document.getElementById('scale-roi-90'),
            scaleRoi12m: document.getElementById('scale-roi-12m'),
        };

        // --- CORE FUNCTIONS ---

        const formatCurrency = (num) => {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                maximumFractionDigits: 0
            }).format(num);
        };

        const calculateTotal = () => {
            // Update State
            state.inputs.targets = parseInt(els.targets.value) || 0;
            state.inputs.conv = parseFloat(els.conv.value) || 0;
            state.inputs.spend = parseInt(els.spend.value) || 0;
            state.inputs.tenure = parseInt(els.tenure.value) || 1;
            state.inputs.margin = parseInt(els.margin.value) || 37;
            state.inputs.manCost = parseInt(els.manCost.value) || 0;
            state.inputs.nurture = els.nurture.checked;
            state.inputs.deck = els.deck.checked;
            state.inputs.lp = els.lp.checked;

            // ROI Math
            els.displayConv.textContent = state.inputs.conv.toFixed(1) + '%';
            els.displayTenure.textContent = state.inputs.tenure; 
            
            const ltv = state.inputs.spend * state.inputs.tenure;
            els.displayLtv.textContent = formatCurrency(ltv);
            
            const newClients = state.inputs.targets * (state.inputs.conv / 100);
            const pilotRevenue = newClients * ltv;
            
            state.budgetLimit = pilotRevenue * (state.inputs.margin / 100);
            els.summaryBudget.textContent = formatCurrency(state.budgetLimit);
            els.displayBreakevenRow.textContent = formatCurrency(state.budgetLimit);

            // Costs
            // Phase 3 (Project Support $1500*3 = $4500 fixed)
            let p3 = 4500; 
            if(state.inputs.nurture) p3 += 750;
            if(state.inputs.deck) p3 += 2000;
            if(state.inputs.lp) p3 += 2000;
            state.costs.phase3 = p3;
            els.phase3Total.textContent = formatCurrency(p3);

            // Phase 2b Production
            let prod = 0;
            if (state.inputs.manSource === 'mr') prod += (state.inputs.manCost * state.inputs.targets);
            if (state.inputs.distSource === 'mr') prod += (state.inputs.distBase + state.inputs.distMat);
            state.costs.prodTotal = prod;
            els.displayPhase2bTotal.textContent = formatCurrency(prod);
            
            updateSidebar();
        };

        const updateSidebar = () => {
            let html = '';
            let minTotal = 0;
            let maxTotal = 0;
            let total12m = 0; 

            // Dynamic Context Text (Sidebar uses "customer")
            const newCustomers = state.inputs.targets * (state.inputs.conv / 100);
            const custLabel = newCustomers > 1 || newCustomers === 0 ? 'customers' : 'customer';
            const formattedCust = newCustomers % 1 === 0 ? newCustomers : newCustomers.toFixed(1);
            els.sidebarContext.textContent = `${state.inputs.conv.toFixed(1)}% conversion rate = ${formattedCust} new ${custLabel} during trial period`;

            // 12m Logic Calculations
            // 12m Production = 90day Total * 4
            let prod12m = state.costs.prodTotal * 4;
            // 12m Follow Up = $6,000 fixed
            let follow12m = 6000;
            // Total 12m = Prod + Follow Up (Blueprint/Creative are $0)
            total12m = prod12m + follow12m;

            const addRow = (label, minCost, maxCost, highlight=false) => {
                minTotal += minCost;
                maxTotal += maxCost;
                
                let costStr = formatCurrency(minCost);
                if (minCost !== maxCost) costStr = `${formatCurrency(minCost)} - ${formatCurrency(maxCost)}`;

                // Sidebar HTML (Standard Style)
                html += `
                    <div class="flex justify-between items-center ${highlight ? 'text-slate-900 font-bold' : 'text-slate-500'}">
                        <span>${label}</span>
                        <span>${costStr}</span>
                    </div>
                `;
            };

            // Sidebar Rows
            if (state.step > 1) addRow('Phase 1: Blueprint', state.costs.phase1, state.costs.phase1, true);
            if (state.step > 2) addRow('Phase 2: Creative', state.costs.phase2Min, state.costs.phase2Max, true);
            if (state.step > 3) {
                if (state.costs.prodTotal > 0) addRow('Phase 2b: Production', state.costs.prodTotal, state.costs.prodTotal, true);
                else html += `<div class="flex justify-between items-center text-slate-400 italic"><span>Phase 2b: Production</span><span>$0 (Client)</span></div>`;
            }
            if (state.step > 4) addRow('Phase 3: Follow-Up', state.costs.phase3, state.costs.phase3, true);

            if (html === '') html = '<div class="text-center text-slate-400 italic text-[10px] py-4">Initializing...</div>';
            els.summaryList.innerHTML = html;

            // -- Update Step 6 (Summary Card) --
            els.summaryRowProd.textContent = formatCurrency(state.costs.prodTotal);
            els.summaryRowFollow.textContent = formatCurrency(state.costs.phase3);
            
            let totalStr = formatCurrency(minTotal);
            if (minTotal !== maxTotal) totalStr = `${formatCurrency(minTotal)} - ${formatCurrency(maxTotal)}`;
            els.finalSummaryTotal.textContent = totalStr;

            // -- Update Step 7 (Scale Table) --
            // Dynamic Headers
            const targets12m = state.inputs.targets * 4;
            const newCust12m = targets12m * (state.inputs.conv / 100);
            const custLabel12m = newCust12m > 1 || newCust12m === 0 ? 'Clients' : 'Client';
            // Calculate label for 90 Day Pilot column specifically as 'Client/s'
            const custLabel90 = newCustomers > 1 || newCustomers === 0 ? 'Clients' : 'Client';
            
            els.scaleQty90.textContent = `${state.inputs.targets} Packages`;
            els.scaleClients90.textContent = `${formattedCust} New ${custLabel90}`;
            
            els.scaleQty12m.textContent = `${targets12m} Packages`;
            els.scaleClients12m.textContent = `${newCust12m % 1 === 0 ? newCust12m : newCust12m.toFixed(1)} New ${custLabel12m}`;

            // Rows
            els.scaleRowProd90.textContent = formatCurrency(state.costs.prodTotal);
            els.scaleRowProd12m.textContent = formatCurrency(prod12m);
            els.scaleRowFollow90.textContent = formatCurrency(state.costs.phase3);
            
            els.scaleTotal90.textContent = totalStr;
            els.scaleTotal12m.textContent = formatCurrency(total12m);
            
            els.scaleBreakeven90.textContent = formatCurrency(state.budgetLimit);
            els.scaleBreakeven12m.textContent = formatCurrency(state.budgetLimit * 4); 

            // -- Calculate ROI Row (Step 7) --
            // 90 Day ROI Range: (Budget / maxTotal) to (Budget / minTotal)
            // If min==max, single value.
            let roi90 = "0%";
            if (maxTotal > 0) {
                const roiMin = (state.budgetLimit / maxTotal) * 100;
                const roiMax = (state.budgetLimit / minTotal) * 100;
                if (minTotal === maxTotal) {
                    roi90 = Math.round(roiMin) + "%";
                } else {
                    roi90 = Math.round(roiMin) + "% - " + Math.round(roiMax) + "%";
                }
            }
            els.scaleRoi90.textContent = roi90;

            // 12m ROI: (Budget*4 / total12m)
            let roi12m = "0%";
            if (total12m > 0) {
                const roiVal = ((state.budgetLimit * 4) / total12m) * 100;
                roi12m = Math.round(roiVal) + "%";
            }
            els.scaleRoi12m.textContent = roi12m;


            // Sidebar Totals
            els.summaryTotal.textContent = totalStr;

            // Budget Logic
            const budgetPercent = state.budgetLimit > 0 ? Math.min(100, (minTotal / state.budgetLimit) * 100) : 0;
            els.budgetBar.style.width = `${budgetPercent}%`;
            els.budgetPercent.textContent = `${Math.round(budgetPercent)}%`;

            if (budgetPercent > 100) {
                els.summaryTotal.classList.add('text-red-600');
                els.budgetWarning.classList.remove('hidden');
                els.budgetBar.classList.remove('bg-slate-900');
                els.budgetBar.classList.add('bg-red-600');
            } else {
                els.summaryTotal.classList.remove('text-red-600');
                els.budgetWarning.classList.add('hidden');
                els.budgetBar.classList.add('bg-slate-900');
                els.budgetBar.classList.remove('bg-red-600');
            }
        };

        const toggleProd = (type, source) => {
            state.inputs[`${type}Source`] = source;
            const isMan = type === 'man';
            const mrId = isMan ? 'card-man-mr' : 'card-dist-mr';
            const boostId = isMan ? 'card-man-boost' : 'card-dist-boost';
            const checkMr = isMan ? 'check-man-mr' : 'check-dist-mr';
            const checkBoost = isMan ? 'check-man-boost' : 'check-dist-boost';

            const mrCard = document.getElementById(mrId);
            const boostCard = document.getElementById(boostId);
            const mrCheck = document.getElementById(checkMr);
            const boostCheck = document.getElementById(checkBoost);

            if (source === 'mr') {
                mrCard.className = "border rounded-lg p-3 cursor-pointer transition-all card-selected relative";
                boostCard.className = "border rounded-lg p-3 cursor-pointer transition-all card-unselected relative";
                mrCheck.classList.remove('hidden');
                boostCheck.classList.add('hidden');
            } else {
                mrCard.className = "border rounded-lg p-3 cursor-pointer transition-all card-unselected relative";
                boostCard.className = "border rounded-lg p-3 cursor-pointer transition-all card-selected relative";
                mrCheck.classList.add('hidden');
                boostCheck.classList.remove('hidden');
            }
            calculateTotal();
        };

        const toggleCardStyle = (id) => {
            const card = document.getElementById(`card-${id}`);
            const checkbox = document.getElementById(`check-${id}`);
            if (checkbox.checked) {
                card.classList.remove('border-slate-300', 'bg-slate-50');
                card.classList.add('border-slate-900', 'bg-slate-100'); 
            } else {
                card.classList.add('border-slate-300', 'bg-slate-50');
                card.classList.remove('border-slate-900', 'bg-slate-100');
            }
            calculateTotal();
        };

        const nav = (dir) => {
            if (dir === 'next' && state.step < state.totalSteps) state.step++;
            if (dir === 'back' && state.step > 1) state.step--;
            updateScreen();
        };

        const updateScreen = () => {
            els.screens.forEach(s => {
                s.classList.remove('step-active', 'slide-in');
                s.classList.add('step-hidden');
            });

            const current = els.screens[state.step - 1];
            current.classList.remove('step-hidden');
            void current.offsetWidth; 
            current.classList.add('step-active', 'slide-in');

            els.progressBar.style.width = `${(state.step / state.totalSteps) * 100}%`;
            Array.from(els.progressLabels).forEach((label, idx) => {
                if(idx < state.step) {
                    label.classList.add('text-slate-900');
                    label.classList.remove('text-slate-400');
                } else {
                    label.classList.add('text-slate-400');
                    label.classList.remove('text-slate-900');
                }
            });

            els.btnBack.disabled = state.step === 1;
            els.btnNext.innerHTML = state.step === state.totalSteps ? 
                `Finish <i data-lucide="check" class="w-3 h-3"></i>` : 
                `Next Step <i data-lucide="arrow-right" class="w-3 h-3"></i>`;

            // Layout Switching Logic for Step 7
            if (state.step === 7) {
                els.btnNext.style.display = 'none'; 
                // Hide sidebar, expand main
                els.layoutSidebar.classList.add('hidden');
                els.layoutMain.classList.remove('lg:col-span-8');
                els.layoutMain.classList.add('lg:col-span-12');
            } else {
                els.btnNext.style.display = 'flex';
                // Show sidebar, reset main
                els.layoutSidebar.classList.remove('hidden');
                els.layoutMain.classList.add('lg:col-span-8');
                els.layoutMain.classList.remove('lg:col-span-12');
            }

            updateSidebar();
            lucide.createIcons();
        };

        // --- LISTENERS ---
        els.targets.addEventListener('input', calculateTotal);
        els.conv.addEventListener('input', calculateTotal);
        els.spend.addEventListener('input', calculateTotal);
        els.tenure.addEventListener('input', calculateTotal);
        els.margin.addEventListener('input', calculateTotal);
        els.manCost.addEventListener('input', calculateTotal);

        els.btnNext.addEventListener('click', () => nav('next'));
        els.btnBack.addEventListener('click', () => nav('back'));

        // --- INIT ---
        toggleProd('man', 'mr');
        toggleProd('dist', 'mr'); 
        toggleCardStyle('deck');
        toggleCardStyle('lp');
        calculateTotal();
        lucide.createIcons();

    </script>
</body>
</html>
